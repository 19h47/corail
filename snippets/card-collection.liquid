{% comment %}
    Renders a collection card

    Accepts:
    - card_collection: {Object} Collection Liquid object
    - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
    - columns: {Number}
    - extend_height: {Boolean} Card height extends to available container space. Default: false (optional)
    - wrapper_class: {String} Wrapper class for card (optional)

    Usage:
    {% render 'card-collection' %}
{% endcomment %}

{%- liquid
	assign ratio = 1

	if card_collection.featured_image and media_aspect_ratio == 'portrait'
		assign ratio = 0.8
	elsif card_collection.featured_image and media_aspect_ratio == 'adapt'
		assign ratio = card_collection.featured_image.aspect_ratio
	endif

	if ratio == 0 or ratio == nil
		assign ratio = 1
	endif

	if wrapper_class == nil or wrapper_class == 'none'
	endif
-%}

<article class="relative">
	<div class="relative h-[16.875rem] bg-gray-very-light lg:h-[28rem] mb-2 lg:mb-0">
		{%- if card_collection.featured_image -%}

			<img
				srcset="{%- if card_collection.featured_image.width >= 165 -%}{{ card_collection.featured_image | image_url: width: 165 }} 165w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 330 -%}{{ card_collection.featured_image | image_url: width: 330 }} 330w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 535 -%}{{ card_collection.featured_image | image_url: width: 535 }} 535w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 750 -%}{{ card_collection.featured_image | image_url: width: 750 }} 750w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 1000 -%}{{ card_collection.featured_image | image_url: width: 1000 }} 1000w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 1500 -%}{{ card_collection.featured_image | image_url: width: 1500 }} 1500w,{%- endif -%}
					{%- if card_collection.featured_image.width >= 3000 -%}{{ card_collection.featured_image | image_url: width: 3000 }} 3000w,{%- endif -%}
					{{ card_collection.featured_image | image_url }} {{ card_collection.featured_image.width }}w"
				src="{{ card_collection.featured_image | image_url: width: 1500 }}"
				sizes="
				(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 | divided_by: columns }}px,
				(min-width: 750px) {% if columns > 1 %}calc((100vw - 10rem) / 2){% else %}calc(100vw - 10rem){% endif %},
				calc(100vw - 3rem)"
				alt=""
				height="{{ card_collection.featured_image.height }}"
				width="{{ card_collection.featured_image.width }}"
				loading="lazy"
				class="w-full h-full object-cover object-center opacity-100 duration-1000 ease-in-out transition-opacity group-hover:opacity-0"
			>

		{%- endif -%}
	</div>

	<footer class="border-t mt-auto lg:mt-4 border-orange-grayish pt-1.5 lg:pt-3 text-[0.5rem] lg:text-sm leading-[1.125rem] lg:leading-4 uppercase">
		<div class="flex justify-between">
			<h3>
				<a{% if card_collection == blank %} role="link" aria-disabled="true"{% else %} href="{{ card_collection.url }}"{% endif %} class="full-unstyled-link">
					{%- if card_collection.title != blank -%}
						{{- card_collection.title | escape -}}
					{%- else -%}
						{{ 'onboarding.collection_title' | t }}
					{%- endif -%}
				</a>
			</h3>
			{%- if card_collection.featured_image == nil and card_collection.description != blank -%}
				<p class="card__caption">
					{{- card_collection.description | strip_html | truncatewords: 12 -}}<span class="icon-wrap">&nbsp;{% render 'icon-arrow' %}</span>
				</p>
			{%- endif -%}
		</div>
	</footer>

	<a
		class="absolute inset-0 w-full h-full z-1 block"
		{% if card_collection == blank %} role="link" aria-disabled="true" {% else %} href="{{ card_collection.url }}" {% endif %}
	></a>

</article>
